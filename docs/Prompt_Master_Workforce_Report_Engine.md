Baik. Ini keputusan **sangat tepat** üëç
Anda benar: **AI tidak boleh bergantung pada artefak eksternal (Dtbase.pdf)** yang tidak selalu tersedia.
Solusinya adalah **mengubah referensi berbasis dokumen ‚Üí referensi berbasis spesifikasi bisnis eksplisit**.

Di bawah ini saya berikan **VERSI FINAL**:

* ‚ùå **Tanpa menyebut ‚ÄúDtbase.pdf‚Äù sama sekali**
* ‚úÖ Semua kebutuhan **tetap identik secara substansi**
* ‚úÖ AI dipaksa mengikuti **aturan sistem**, bukan menebak dari file

---

# üß† PROMPT MASTER (REVISED & CLEAN)

## **Workforce Report Engine ‚Äì Official Workforce Structural Report**

---

## ROLE & CONTEXT

```
You are a Senior Odoo Architect & Workforce Reporting Specialist.

You are implementing a NEW, SEPARATE feature:
"Workforce Report Engine"

This feature is NOT:
- Dashboard analytics
- Generic graph export
- Flexible reporting

This feature IS:
- Official workforce structural report
- Snapshot-based
- Unit-centric
- Audit-ready
- PDF as authoritative document
```

---

## BUSINESS CONTEXT (EXPLICIT, NO EXTERNAL FILE)

```
The organization requires an OFFICIAL workforce report used for:
- Foundation-level reporting
- Management decision making
- Internal audit and reconciliation

This report has strict characteristics:
- Numbers must be stable and reproducible
- Structure is fixed by the system
- Data is aggregated by organizational unit
- Period is based on end-of-month cut-off
```

---

## NON-NEGOTIABLE PRINCIPLES

```
1. Snapshot-based ONLY (end-of-month)
2. Organizational Unit is the PRIMARY dimension
3. Employment classifications are FIXED and explicit
4. Backend aggregation ONLY
5. PDF output is FINAL, READ-ONLY, and authoritative
6. No exploratory analytics
7. No user-defined chart selection
```

---

## CORE DATA DEFINITIONS (SYSTEM-OWNED)

### Employment Type

```
- payroll
- non_payroll
```

### Employment Status (MUST NOT BE SIMPLIFIED)

```
- tetap
- pkwt
- spk
- thl
- hju
- pns_dpk
```

---

## EXECUTION PHASES

---

### PHASE 1 ‚Äì SNAPSHOT FOUNDATION

```
Create an immutable workforce snapshot model.

Snapshot characteristics:
- Generated at the end of each month
- Never recalculated
- Mandatory for report generation
- Represents the official workforce state for that period
```

**Snapshot Model**

```
workforce_snapshot
- employee_id
- unit_id
- gender (L / P)
- employment_type (payroll / non_payroll)
- employment_status (see fixed list)
- snapshot_month
- snapshot_year
- is_active
```

---

### PHASE 2 ‚Äì AGGREGATION SERVICE (STRUCTURAL LOGIC)

```
Create a dedicated workforce analytics service.

This service:
- Consumes snapshot data ONLY
- Returns aggregated results ONLY
- Never exposes employee-level records
```

**Required Aggregations**

```
1. Payroll vs Non-Payroll per Unit (with gender breakdown)
2. Total Workforce per Unit (including all employment statuses)
3. Monthly Workforce Snapshot per Unit (Jan‚ÄìDec)
4. Employment Status Distribution (structural composition)
```

---

### PHASE 3 ‚Äì REPORT STRUCTURE (FIXED & SYSTEM-DEFINED)

```
The report structure is NOT configurable by users.

The PDF MUST contain sections in this exact order:

1. Report Header
   - Organization name
   - Reporting period (month & year)

2. Table:
   Payroll vs Non-Payroll per Unit (Male / Female / Total)

3. Bar Chart:
   Payroll vs Non-Payroll per Unit

4. Bar Chart:
   Total Workforce per Unit
   (including special employment statuses)

5. Table:
   Workforce Snapshot per Unit (Jan‚ÄìDec)

6. Chart:
   Employment Status Distribution

7. Report Footer
   - Generated timestamp
   - Generated by user
```

---

### PHASE 4 ‚Äì PDF & VISUAL STANDARD

```
- QWeb PDF
- Landscape orientation
- Minimum 300 DPI
- Flat, neutral colors
- Charts must match tables exactly
- SVG preferred, PNG fallback
```

---

### PHASE 5 ‚Äì USER FLOW (STRICT)

```
Menu: Workforce Report

User input:
- Month
- Year

System behavior:
- Validate snapshot existence
- Generate report
- Return PDF

Disallowed:
- Free filters
- Chart selection
- Dynamic grouping
```

---

## VALIDATION RULES

```
1. All totals must reconcile across sections
2. Regenerating the same period yields identical results
3. Report generation is blocked if snapshot is missing
4. Any discrepancy between tables and charts is a failure
```

---

## FAILURE CONDITIONS (HARD STOP)

```
- Using realtime employee data
- Allowing exploratory analytics
- Treating this as export feature
- Making report structure configurable